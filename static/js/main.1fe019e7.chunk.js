(this.webpackJsonpbabble=this.webpackJsonpbabble||[]).push([[0],{101:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),i=n(71),s=n.n(i),r=(n(90),n(61)),o=n.n(r),l=n(72),u=n(8),b=n(110),j=n(111),d=n(81),h=n(112),f=n(113),x=n(120),p=n(114),g=n(117),m=n(32),O=(n(92),n(102),m.a.initializeApp({apiKey:"AIzaSyAfP6rQlttolZzyQLsSzTIi0hBsBaQI_nY",authDomain:"babble-4fe6a.firebaseapp.com",projectId:"babble-4fe6a",storageBucket:"babble-4fe6a.appspot.com",messagingSenderId:"535172438321",appId:"1:535172438321:web:7e89165b6205ee7388b810",measurementId:"G-EVT93D4GXS"})),v=O.auth(),w=O.firestore(),y=n(73),I=n(119),S=n(3);function U(e){return Math.floor(Math.sqrt(e)/2)}function z(e){return 0===e?"#cdcdcd":e<=2?"#adff2f":e<=4?"#00bfff":e<=6?"#0000ff":e<=8?"#8a2be2":e<=10?"#ff8c00":"#ff0000"}function A(e){return 0===e||e<=2?"black":"white"}var B=function(e){var t=U(e.exp);return Object(S.jsx)(I.b,{boxSize:"1em",bg:z(t),style:{border:"2px solid white"},children:Object(S.jsx)("span",{style:{color:A(t),fontWeight:"600",fontSize:12},children:t})})},k=function(e){var t=e.message,n=t.uid===v.currentUser.uid?"msgSent":"msgReceived",a=Object(c.useState)(0),i=Object(u.a)(a,2),s=i[0],r=i[1];return w.collection("users").doc(t.uid).get().then((function(e){r(e.get("exp"))})),Object(S.jsx)(S.Fragment,{children:t.uid!==v.currentUser.uid?Object(S.jsxs)(b.a,{direction:"row",align:"center",mt:"10px",ml:"15px",children:[Object(S.jsx)(I.a,{size:"md",src:t.photoURL,children:Object(S.jsx)(B,{exp:s})}),Object(S.jsx)(j.a,{width:"auto",className:"message ".concat(n),children:t.message})]}):Object(S.jsxs)(b.a,{direction:"row",align:"center",justify:"flex-end",mt:"10px",mr:"15px",children:[Object(S.jsx)(j.a,{width:"auto",className:"message ".concat(n),children:t.message}),Object(S.jsx)(I.a,{size:"md",src:t.photoURL,children:Object(S.jsx)(B,{exp:s})})]})})},F=n(25),R=n(22),T=function(){var e=w.collection("messages"),t=e.orderBy("createdAt").limit(25),n=Object(y.a)(t,{idField:"id"}),a=Object(u.a)(n,1)[0],i=Object(c.useState)(""),s=Object(u.a)(i,2),r=s[0],O=s[1],I=Object(c.useState)(!0),z=Object(u.a)(I,2),A=z[0],B=z[1],T=Object(c.useRef)(),G=function(e){w.collection("users").doc(e).get().then((function(e){var t=e.get("exp");U(t)>U(t-1)&&Object(F.b)("You have leveled up!",{icon:"\ud83d\udc4f",duration:7e3})}))};Object(c.useEffect)((function(){T.current.scrollIntoView({behavior:"smooth"})}));return Object(S.jsxs)(b.a,{direction:"column",justify:"flex-end",pb:"45px",bg:"#ffffff",height:"99vh",children:[Object(S.jsx)(F.a,{}),Object(S.jsxs)(j.a,{w:"100%",h:"auto",style:{overflow:"auto",maxHeight:"95%"},children:[a&&a.map((function(e){return Object(S.jsx)(k,{message:e})})),Object(S.jsx)("div",{ref:T})]}),Object(S.jsx)(b.a,{w:"100%",h:"50px",bg:"gray.300",px:"5px",mt:"auto",mr:"5px",align:"center",position:"fixed",bottom:"0",children:Object(S.jsxs)("form",{style:{width:"100%",display:"inline-flex"},onSubmit:function(){var t=Object(l.a)(o.a.mark((function t(n){var c,a,i,s,l;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),c=v.currentUser,a=c.uid,i=c.photoURL,B(!1),setTimeout((function(){B(!0)}),1e3),t.next=5,e.add({message:r,createdAt:m.a.firestore.FieldValue.serverTimestamp(),uid:a,photoURL:i});case 5:return R.a.event({category:"Babble",action:"User sent a message"}),s=m.a.firestore.FieldValue.increment(1),l=w.collection("users").doc(a),t.next=10,l.update({exp:s});case 10:t.sent,G(a),O(""),T.current.scrollIntoView({behavior:"smooth"});case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),children:[Object(S.jsx)(d.a,{isRequired:!0,children:Object(S.jsxs)(h.a,{children:[Object(S.jsx)(f.a,{children:Object(S.jsx)("i",{class:"fas fa-comment-dots"})}),Object(S.jsx)(x.a,{bg:"white",placeholder:"Type your message...",value:r,onChange:function(e){e.target.value.length>100&&(e.target.value=e.target.value.slice(0,100)),O(e.target.value)}})]})}),Object(S.jsx)(p.a,{orientation:"vertical"}),Object(S.jsx)(g.a,{ml:"5px",type:"submit",colorScheme:"blue",isDisabled:!A,rightIcon:Object(S.jsx)("i",{class:"fas fa-paper-plane"}),children:"Send"})]})})]})},G=n(115),N=function(){return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(F.a,{}),Object(S.jsx)(g.a,{h:"40px",ml:"auto",colorScheme:"red",disabled:!v.currentUser,rightIcon:Object(S.jsx)("i",{class:"fas fa-sign-out-alt"}),onClick:function(){v.currentUser&&(v.signOut(),R.a.event({category:"Babble",action:"User has signed out"}),Object(F.b)("You have signed out.",{icon:"\ud83d\udeaa",duration:3e3}))},children:"Sign out"})]})},L=function(){return Object(S.jsxs)(b.a,{direction:"row",px:"5px",align:"center",h:"50px",w:"100%",bg:"white",position:"fixed",top:"0",zIndex:"1",children:[Object(S.jsxs)(G.a,{className:"navbar-logo",fontFamily:"Poppins",fontWeight:"600",fontSize:"lg",ml:"10px",children:[Object(S.jsx)("i",{class:"fas fa-comments emphasis"})," Babble"]}),Object(S.jsx)(N,{})]})},V=n(76),D=n(116);var E=function(){return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(F.a,{}),Object(S.jsx)(D.a,{w:"100%",h:"90vh",bg:"white",children:Object(S.jsx)(g.a,{colorScheme:"green",leftIcon:Object(S.jsx)("i",{class:"fas fa-sign-in-alt"}),onClick:function(){!function(){var e=new m.a.auth.GoogleAuthProvider;v.signInWithPopup(e).then((function(e){w.collection("users").doc(v.currentUser.uid).get().then((function(t){if(!t.exists)return w.collection("users").doc(e.user.uid).set({exp:0},{merge:!0})}))})).then((function(){R.a.event({category:"Babble",action:"User has signed in"}),F.b.success("You have signed in!",{duration:3e3})}))}()},children:"Sign-in with Google"})})]})},P=function(){var e=Object(V.a)(v),t=Object(u.a)(e,3),n=t[0];t[1],t[2];return Object(S.jsxs)(j.a,{w:"100vw",h:"100vh",bg:"white",children:[Object(S.jsx)(L,{}),n?Object(S.jsx)(T,{}):Object(S.jsx)(E,{})]})};var Y=function(){return Object(c.useEffect)((function(){window.GA_INIT||(R.a.initialize("UA-186165133-1"),window.GA_INIT=!0),R.a.set({page:window.location.pathname}),R.a.pageview(window.location.pathname)})),Object(S.jsx)("div",{className:"App",children:Object(S.jsx)(P,{})})},C=n(118);s.a.render(Object(S.jsx)(a.a.StrictMode,{children:Object(S.jsx)(C.a,{children:Object(S.jsx)(Y,{})})}),document.getElementById("root"))},90:function(e,t,n){}},[[101,1,2]]]);
//# sourceMappingURL=main.1fe019e7.chunk.js.map